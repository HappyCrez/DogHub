{
"members":
"SELECT u.id AS member_id, u.full_name, u.phone, u.email, u.city, u.avatar_url, u.bio AS owner_bio, u.join_date, u.membership_end_date, u.role, d.id   AS dog_id, d.name AS dog_name, d.breed, d.sex, d.birth_date, d.chip_number, d.photo AS dog_photo, d.tags  AS dog_tags, d.bio AS dog_bio FROM member u LEFT JOIN dog d ON u.id = d.member_id ORDER BY u.full_name, d.name;",

  "events":
  "SELECT e.id, e.title, e.category, e.start_at, e.end_at, e.venue, e.price, e.description, (SELECT COUNT(*) FROM event_registration er WHERE er.event_id = e.id) AS registered_count FROM event e WHERE e.category <> 'Образование' OR e.category IS NULL ORDER BY e.start_at;",

  "event":
  "SELECT id, title, category, start_at, end_at, venue, price, description FROM event WHERE id = @id;",

  "programs":
  "SELECT p.id, p.title, p.type, p.price, p.description, COUNT(pr.dog_id) AS registered_dogs_count FROM program p LEFT JOIN program_registration pr ON p.id = pr.program_id GROUP BY p.id, p.title, p.type, p.price, p.description ORDER BY p.type, p.title;",

  "people_events":
  "SELECT e.id, e.title, e.category, e.start_at, e.end_at, e.venue, e.price, e.description, (SELECT COUNT(*) FROM event_registration er WHERE er.event_id = e.id) AS registered_count FROM event e WHERE e.category = 'Образование' ORDER BY e.start_at DESC;",

  "chiped":
  "SELECT d.id AS dog_id, d.name AS dog_name, d.breed, d.sex, d.birth_date, d.chip_number, d.photo, d.tags, d.bio, u.full_name AS owner_name, u.phone AS owner_phone, u.email AS owner_email FROM dog d JOIN member u ON d.member_id = u.id WHERE d.chip_number IS NOT NULL ORDER BY u.full_name, d.name;",

  "dogs":
  "SELECT d.id AS dog_id, d.name AS dog_name, d.breed, d.sex, d.birth_date, d.chip_number, d.photo, d.tags, d.bio, u.full_name AS owner_name, u.phone AS owner_phone, u.email AS owner_email FROM dog d JOIN member u ON d.member_id = u.id ORDER BY u.full_name, d.name;",

  "service_types":
  "SELECT id, name, price FROM service_type ORDER BY name;",

  "dog_services_by_member":
  "SELECT ds.id, ds.dog_id, d.name AS dog_name, ds.service_type_id, COALESCE(ds.service_name, st.name) AS service_name, ds.requested_at, ds.performed_at, ds.price, ds.status FROM dog_service ds JOIN dog d ON d.id = ds.dog_id JOIN service_type st ON st.id = ds.service_type_id WHERE (@member_id IS NULL OR d.member_id = @member_id) ORDER BY ds.requested_at DESC;",

  "event_dogs":
  "SELECT d.id AS dog_id, d.name AS dog_name, d.breed, d.sex, d.birth_date, d.chip_number, d.photo, o.full_name  AS owner_full_name, o.city AS owner_city, d.tags, d.bio FROM event_registration er JOIN dog d ON d.id = er.dog_id JOIN member o ON o.id = d.member_id WHERE er.event_id = @event_id;",

  "program_dogs": 
  "SELECT d.id AS dog_id, d.name AS dog_name, d.breed, d.sex, d.birth_date, d.chip_number, d.photo, m.full_name AS owner_full_name, m.city AS owner_city, d.tags, d.bio FROM program_registration pr JOIN dog d ON d.id = pr.dog_id JOIN member m ON m.id = d.member_id WHERE pr.program_id = @program_id;",

  "event_members": 
  "SELECT DISTINCT m.id AS member_id, m.full_name, m.phone, m.email, m.city, m.avatar_url, m.bio, m.join_date, m.membership_end_date, m.role FROM event_registration er JOIN member m ON er.member_id = m.id WHERE er.event_id = @event_id;",
  
  "notifications":
  "SELECT * from member WHERE id=1;",
  
  "get_member_by_email":
  "SELECT m.id AS member_id, m.full_name, m.phone, m.email, m.city, m.avatar_url, m.bio AS owner_bio, m.join_date, m.membership_end_date, m.role, m.password_hash AS password_hash FROM member m WHERE m.email = @email;",

  "get_member_by_id":
  "SELECT m.id AS member_id, m.full_name, m.phone, m.email, m.city, m.avatar_url, m.bio AS owner_bio, m.join_date, m.membership_end_date, m.role FROM member m WHERE m.id = @member_id;",

  "insert_member_for_auth":
  "INSERT INTO member (full_name, phone, email, city, avatar_url, bio, join_date, membership_end_date, role, password_hash) VALUES (@full_name, @phone, @email, @city, NULL, NULL, CURRENT_DATE, NULL, 'Пользователь', @password_hash);",

  "insert_refresh_token":
  "INSERT INTO refresh_token (member_id, token_hash, user_agent, ip_address, expires_at) VALUES (@member_id, @token_hash, @user_agent, @ip_address, @expires_at) RETURNING id, member_id, expires_at, revoked_at;",

  "get_refresh_token":
  "SELECT id, member_id, token_hash, user_agent, ip_address, created_at, expires_at, revoked_at FROM refresh_token WHERE token_hash = @token_hash AND revoked_at IS NULL AND expires_at > NOW() LIMIT 1;",

  "revoke_refresh_token":
  "UPDATE refresh_token SET revoked_at = CURRENT_TIMESTAMP WHERE id = @id RETURNING id;",

  "revoke_member_tokens":
  "UPDATE refresh_token SET revoked_at = CURRENT_TIMESTAMP WHERE member_id = @member_id AND revoked_at IS NULL;",

  "dog_report_info":
  "SELECT d.id, d.name AS dog_name, d.breed, d.sex, d.birth_date, d.chip_number, d.photo, d.bio AS dog_bio, d.tags, m.full_name AS owner_name, m.phone AS owner_phone, m.email AS owner_email, (SELECT COUNT(*) FROM program_registration pr WHERE pr.dog_id = d.id) AS program_count, (SELECT COUNT(*) FROM dog_service ds WHERE ds.dog_id = d.id) AS service_count, (SELECT COUNT(*) FROM event_registration er WHERE er.dog_id = d.id) AS event_count FROM dog d LEFT JOIN member m ON d.member_id = m.id WHERE d.id = @id;"
}